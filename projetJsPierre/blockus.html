<!doctype html>
<html>
       <!--  ////////////// HEAD ///////////////////// -->
    <head>
           
    <meta charset="UTF-8">
    <title>Blockus </title>
    <link href="custom.css">
    <script>
        ////////////////////////////////////// DEBUT DES VAR //////////////////////////////////////////////
       /////////////////////////////////////// LES VAR GLOBALES ///////////////////////////////////////////
        ///////////////LES VAR TEST/////
        var  testB = 0;
        ////////////////////////////////
        var context = null;
        // clic sur la zone de jeu (coordonnées relatives au canvas)
        var clic = { x: 0, y: 0 };
        //var faux = { hauteur: 32, largeur: 32, couleur: "" };
        // var vrai = { hauteur: 32, largeur: 32, couleur: "RED" };
        var couleurB = "blue";
        var couleurR = "red";
        var couleurJ = "yellow";
        var couleurV = "green";
        var posCarreX = 10;
        var posCarreY = 10;
        var posCarreX = 5;
        var posCarreY = 5;
        var posX = posCarreX * 32;
        var posY = posCarreY * 32;
        var poser = true;
        var nomPiece;
        var carac;
        var taillePieceGlobale = 32;
        var col = ""
       
        ///////////////////////////CST GLOBALES TAB/////////////////////////////////
        var tabTotale = [ [tab1,tab2,tab3,tab4,tab5,tab6,tab7, tab8, tab9,tab10,tab11,tab12,tab13,tab14,tab15,tab16
                          ,tab17,tab18,tab19,tab20,tab21]];
        var tab1 = [ [false, false, false, false, false],
                    [false, false, false, false, false],
                    [false, false, true, false, false],
                    [false, false, false, false, false],
                    [false, false, false, false, false]];
        var tab2 = 
                [[false, false, false, false, false],
                [false, false, true, false, false ],
                [false, false, true, false, false ],
                [false, false, false, false, false],
                [false, false, false, false, false]];
        var tab3 = [[false, false, false, false, false],
                [false, false, true, false, false],
                [false, false, true, false, false],
                [false, false, true, false, false],
                [false, false, false, false, false]];
        var tab4 =  [[false, false, false, false, false],
                [false, false, true, false, false],
                [false, false, true, true, false],
                [false, false, false, false, false],
                [false, false, false, false, false]];
        var tab5 = [[false, false, false, false, false],
                [false, false, true, false, false],
                [false, false, true, false, false],
                [false, false, true, false, false],
                [false, false, true, false, false]];
        var tab6 = [[false, false, false, false, false],
                [false, false, true, false, false],
                [false, false, true, false, false],
                [false, true, true, false, false],
                [false, false, false, false, false]];
        var tab7 =  [[false, false, false, false, false],
                [false, false, true, false, false],
                [false, false, true, true, false],
                [false, false, true, false, false],
                [false, false, false, false, false]];
        var tab8 = [[false, false, false, false, false],
                [false, false, true, true, false],
                [false, false, true, true, false],
                [false, false, false, false, false],
                [false, false, false, false, false]];
        var tab9 = [[false, false, false, false, false],
                [false, true, true, false, false],
                [false, false, true, true, false],
                [false, false, false, false, false],
                [false, false, false, false, false]];
        var tab10 = [[false, false, true, false, false],
                [false, false, true, false, false],
                [false, false, true, false, false],
                [false, false, true, false, false],
                [false, false, true, false, false]];
        var tab11 = [[false, false, false, false, false],
                [false, false, true, false, false],
                [false, false, true, false, false],
                [false, false, true, false, false],
                [false, true, true, false, false]];
        var tab12 = [[false, false, false, false, false],
                [false, false, true, false, false],
                [false, false, true, false, false],
                [false, true, true, false, false],
                [false, true, false, false, false]];
        var tab13 = [[false, false, false, false, false],
                [false, false, true, false, false],
                [false, true, true, false, false],
                [false, true, true, false, false],
                [false, false, false, false, false]];
        var tab14 = [[false, false, false, false, false],
                [false, false, true, true, false],
                [false, false, false, true, false],
                [false, false, true, true, false],
                [false, false, false, false, false]];
        var tab15 = [[false, false, false, false, false],
                [false, false, true, false, false],
                [false, false, true, true, false],
                [false, false, true, false, false],
                [false, false, true, false, false]];
        var tab16 =  [[false, false, false, false, false],
                [false, false, true, false, false],
                [false, false, true, false, false],
                [false, true, true, true, false],
                [false, false, false, false, false]];
        var tab17 = [[false, false, false, false, false],
                [false, true, false, false, false],
                [false, true, false, false, false],
                [false, true, true, true, false],
                [false, false, false, false, false]];
        var tab18 =  [[false, false, false, false, false],
                [false, true, true, false, false],
                [false, false, true, true, false],
                [false, false, false, true, false],
                [false, false, false, false, false]];
        var tab19 =  [[false, false, false, false, false],
                [false, true, false, false, false],
                [false, true, true, true, false],
                [false, false, false, true, false],
                [false, false, false, false, false]];
        var tab20 =  [[false, false, false, false, false],
                [false, true, false, false, false],
                [false, true, true, true, false],
                [false, false, true, false, false],
                [false, false, false, false, false]];
        var tab21 = [[false, false, false, false, false],
                    [false, false, true, false, false],
                    [false, true, true, true, false],
                    [false, false, true, false, false],
                    [false, false, false, false, false]];
        ///////////////////////////CST GLOBALES TAB/////////////////////////////////
        /////////////////////////////////////// LES VAR GLOBALES ///////////////////////////////////////////
         //////////////////////////////////////////LES CLASSES/////////////////////////////////////////////
        
         class Piece {
            Coordx;
            Coordy;
            hauteur;
            largeur;
            Piece(couleur, tab){
            this.couleur = couleur;
            this.tab = tab; // fonction  a faire qui copie le tableau a deux dimensions
                
                
            }
            
            rotateClic(z, tab){
            tournePieceAxialVertical(z,tab)    
                
            }
             
             rotateMolletteOuBarreEspace(z,tab){
             tournePieceAxialHorizontal(z,tab);
                 
             }
             
             setCoordInit(CoordY,CoordX){
             this.Coordx = CoordY;  
             this.Coordy = CoordX;    
             }
             
             setTaille(){
             this.hauteur = 32;     
             this.largeur = 32;     
                 
             }
        }
        //////////////////////////////////////////LES CLASSES/////////////////////////////////////////////
        
        /////////////////////////////////////////LES INSTANCIATIONS//////////////////////////////////////
        
        var Piece1Rouge = new Piece(couleurR, tab7);
        var Piece1Bleu = new Piece(couleurB, tab7);
        var Piece1Jaune = new Piece(couleurJ, tab7);
        var Piece1Vert = new Piece(couleurV, tab7);
        
        var Piece2Rouge = new Piece(couleurR, tab2);
        var Piece2Bleu = new Piece(couleurB, tab2);
        var Piece2Jaune = new Piece(couleurJ, tab2);
        var Piece2Vert = new Piece(couleurV, tab2);
        
        var Piece3Rouge = new Piece(couleurR, tab3);
        var Piece3Bleu = new Piece(couleurB, tab3);
        var Piece3Jaune = new Piece(couleurJ, tab3);
        var Piece3Vert = new Piece(couleurV, tab3);
        
        var Piece4Rouge = new Piece(couleurR, tab4);
        var Piece4Bleu = new Piece(couleurB, tab4);
        var Piece4Jaune = new Piece(couleurJ, tab4);
        var Piece4Vert = new Piece(couleurV, tab4);
        
        var Piece5Rouge = new Piece(couleurR, tab5);
        var Piece5Bleu = new Piece(couleurB, tab5);
        var Piece5Jaune = new Piece(couleurJ, tab5);
        var Piece5Vert = new Piece(couleurV, tab5);
        
        var Piece6Rouge = new Piece(couleurR, tab6);
        var Piece6Bleu = new Piece(couleurB, tab6);
        var Piece6Jaune = new Piece(couleurJ, tab6);
        var Piece6Vert = new Piece(couleurV, tab6);
        
        var Piece7Rouge = new Piece(couleurR, tab7);
        var Piece7Bleu = new Piece(couleurB, tab7);
        var Piece7Jaune = new Piece(couleurJ, tab7);
        var Piece7Vert = new Piece(couleurV, tab7);
        
        var Piece8Rouge = new Piece(couleurR, tab8);
        var Piece8Bleu = new Piece(couleurB, tab8);
        var Piece8Jaune = new Piece(couleurJ, tab8);
        var Piece8Vert = new Piece(couleurV, tab8);
        
        var Piece9Rouge = new Piece(couleurR, tab9);
        var Piece9Bleu = new Piece(couleurB, tab9);
        var Piece9Jaune = new Piece(couleurJ, tab9);
        var Piece9Vert = new Piece(couleurV, tab9);
        
        var Piece10Rouge = new Piece(couleurR, tab10);
        var Piece10Bleu = new Piece(couleurB, tab10);
        var Piece10Jaune = new Piece(couleurJ, tab10);
        var Piece10Vert = new Piece(couleurV, tab10);
        
        var Piece11Rouge = new Piece(couleurR, tab11);
        var Piece11Bleu = new Piece(couleurB, tab11);
        var Piece11Jaune = new Piece(couleurJ, tab11);
        var Piece11Vert = new Piece(couleurV, tab11);
        
        var Piece12Rouge = new Piece(couleurR, tab12);
        var Piece12Bleu = new Piece(couleurB, tab12);
        var Piece12Jaune = new Piece(couleurJ, tab12);
        var Piece12Vert = new Piece(couleurV, tab12);
        
        var Piece13Rouge = new Piece(couleurR, tab13);
        var Piece13Bleu = new Piece(couleurB, tab13);
        var Piece13Jaune = new Piece(couleurJ, tab13);
        var Piece13Vert = new Piece(couleurV, tab13);
        
        var Piece14Rouge = new Piece(couleurR, tab14);
        var Piece14Bleu = new Piece(couleurB, tab14);
        var Piece14Jaune = new Piece(couleurJ, tab14);
        var Piece14Vert = new Piece(couleurV, tab14);
        
        var Piece15Rouge = new Piece(couleurR, tab15);
        var Piece15Bleu = new Piece(couleurB, tab15);
        var Piece15Jaune = new Piece(couleurJ, tab15);
        var Piece15Vert = new Piece(couleurV, tab15);
        
        var Piece16Rouge = new Piece(couleurR, tab16);
        var Piece16Bleu = new Piece(couleurB, tab16);
        var Piece16Jaune = new Piece(couleurJ, tab16);
        var Piece16Vert = new Piece(couleurV, tab16);
        
        var Piece17Rouge = new Piece(couleurR, tab17);
        var Piece17Bleu = new Piece(couleurB, tab17);
        var Piece17Jaune = new Piece(couleurJ, tab17);
        var Piece17Vert = new Piece(couleurV, tab17);
        
        var Piece18Rouge = new Piece(couleurR, tab18);
        var Piece18Bleu = new Piece(couleurB, tab18);
        var Piece18Jaune = new Piece(couleurJ, tab18);
        var Piece18Vert = new Piece(couleurV, tab18);
        
        var Piece19Rouge = new Piece(couleurR, tab19);
        var Piece19Bleu = new Piece(couleurB, tab19);
        var Piece19Jaune = new Piece(couleurJ, tab19);
        var Piece19Vert = new Piece(couleurV, tab19);
        
        var Piece20Rouge = new Piece(couleurR, tab20);
        var Piece20Bleu = new Piece(couleurB, tab20);
        var Piece20Jaune = new Piece(couleurJ, tab20);
        var Piece20Vert = new Piece(couleurV, tab20);
        
        var Piece21Rouge = new Piece(couleurR, tab21);
        var Piece21Bleu = new Piece(couleurB, tab21);
        var Piece21Jaune = new Piece(couleurJ, tab21);
        var Piece21Vert = new Piece(couleurV, tab21);
      
        
        
         /////////////////////////////////////////LES INSTANCIATIONS//////////////////////////////////////
        // le tour de chaque joueur, initialisé à faux (à pars bleu) pour chaque joueur au debut du jeu
        var turn = {
            turnBleu: true,
            turnRed: false,
            turnGreen: false,
            turnYellow: false,
            
        };
        var ttpiecesB = {
            "piece1Bleu":piece1Bleu,
            "piece2Bleu":piece2Bleu, 
            "piece3Bleu":piece3Bleu,
            "piece4Bleu":piece4Bleu, 
            "piece5Bleu":piece5Bleu, 
            "piece6Bleu":piece6Bleu, 
            "piece7Bleu":piec7eBleu,
            "piece8Bleu":piece8Bleu,
            "piece9Bleu":piece9Bleu, 
            "piece10Bleu":piece10Bleu,
            "piece11Bleu":piece11Bleu,
            "piece12Bleu":piece12Bleu, 
            "piece13Bleu":piece13Bleu, 
            "piece14Bleu":piece14Bleu, 
            "piece15Bleu":piece15Bleu, 
            "piece16Bleu":piece16Bleu, 
            "piece17Bleu":piece17Bleu, 
            "piece18Bleu":piece18Bleu, 
            "piece19Bleu":piece19Bleu, 
            "piece20Bleu":piece20Bleu, 
            "piece21Bleu":piece21Bleu
        };    
        var ttpiecesV = {
            "piece1Vert": piece1Vert,
            "piece2Vert": piece2Vert, 
            "piece3Vert":piece3Vert,
            "piece4Vert":piece4Vert, 
            "piece5Vert":piece5Vert, 
            "piece6Vert":piece6Vert, 
            "piece7Vert":piec7eVert,
            "piece8Vert":piece8Vert,
            "piece9Vert":piece9Vert, 
            "piece10Vert":piece10Vert,
            "piece11Vert":piece11Vert,
            "piece12Vert":piece12Vert, 
            "piece13Vert":piece13Vert, 
            "piece14Vert":piece14Vert, 
            "piece15Vert":piece15Vert, 
            "piece16Vert":piece16Vert, 
            "piece17Vert":piece17Vert, 
            "piece18Vert":piece18Vert, 
            "piece19Vert":piece19Vert, 
            "piece20Vert":piece20Vert, 
            "piece21Vert":piece21Vert
        };    
        var ttpiecesR = {
            "piece1Rouge": piece1Rouge,
            "piece2Rouge": piece2Rouge, 
            "piece3Rouge":piece3Rouge,
            "piece4Rouge":piece4Rouge, 
            "piece5Rouge":piece5Rouge, 
            "piece6Rouge":piece6Rouge, 
            "piece7Rouge":piec7eRouge,
            "piece8Rouge":piece8Rouge,
            "piece9Rouge":piece9Rouge, 
            "piece10Rouge":piece10Rouge,
            "piece11Rouge":piece11Rouge,
            "piece12Rouge":piece12Rouge, 
            "piece13Rouge":piece13Rouge, 
            "piece14Rouge":piece14Rouge, 
            "piece15Rouge":piece15Rouge, 
            "piece16Rouge":piece16Rouge, 
            "piece17Rouge":piece17Rouge, 
            "piece18Rouge":piece18Rouge, 
            "piece19Rouge":piece19Rouge, 
            "piece20Rouge":piece20Rouge, 
            "piece21Rouge":piece21Rouge
        };    
         var ttpiecesJ = {
            "piece1Jaune": piece1Jaune,
            "piece2Jaune": piece2Jaune, 
            "piece3Jaune":piece3Jaune,
            "piece4Jaune":piece4Jaune, 
            "piece5Jaune":piece5Jaune, 
            "piece6Jaune":piece6Jaune, 
            "piece7Jaune":piec7eJaune,
            "piece8Jaune":piece8Jaune,
            "piece9Jaune":piece9Jaune, 
            "piece10Jaune":piece10Jaune,
            "piece11Jaune":piece11Jaune,
            "piece12Jaune":piece12Jaune, 
            "piece13Jaune":piece13Jaune, 
            "piece14Jaune":piece14Jaune, 
            "piece15Jaune":piece15Jaune, 
            "piece16Jaune":piece16Jaune, 
            "piece17Jaune":piece17Jaune, 
            "piece18Jaune":piece18Jaune, 
            "piece19Jaune":piece19Jaune, 
            "piece20Jaune":piece20Jaune, 
            "piece21Jaune":piece21Jaune
        };  
      
        














        //////////////////////FIN DES VAR //////////////////////////////////////

        ////////////////////// LES FONCTIONS ///////////////////////////////////


        /////////////LES FONCTIONS POUR FAIRE FONCTIONNER LE JEU ///////////////

        // initialisation (appelée au chargement du corps du document <body onload="init">)
        init = function () {
            // instanciation de la variable globale contenant le contexte
            context = document.getElementById("cvs").getContext("2d");
            context.width = document.getElementById("cvs").width;
            context.height = document.getElementById("cvs").height;

            // on associe au document des écouteurs d'événements
            // --> voir http://www.w3schools.com/js/js_events.asp

            // 2 écouteurs pour le clavier (appui/relâchement d'une touche)
            document.addEventListener("keydown", captureAppuiToucheClavier)
            document.addEventListener("keyup", captureRelacheToucheClavier)
            // on associe au document un écouteur d'événements souris
            document.addEventListener("click", captureClicSouris)

            // --> ces événements vont appeler les fonctions captureXYZ définies après.

            // lancement de la boucle de jeu
            boucleDeJeu();
        }
           boucleDeJeu = function () {
            // mise à jour de l'état du jeu
            update(Date.now());
            // affichage de l'état du jeu
            render();
            // rappel de la boucle de jeu
            // requestAnimationFrame est une fonction JS servant à pré-calculer le prochain affichage
            //  http://www.html5canvastutorials.com/advanced/html5-canvas-animation-stage/
            requestAnimationFrame(boucleDeJeu);
        }
        /**
        *  Mise à jour de l'état du jeu
        *  @param  d   date courante
        */
        var lastUpdate = Date.now();
        update = function (d) {
            //movePiece(event,piece18);


                
            //dernière maj
            lastUpdate = d;
        }
        /**
         *  Fonction réalisant le rendu de l'état du jeu
         */
        render = function () {
            // effacement de l'écran
            context.clearRect(0, 0, context.width, context.height);
            // affichage du titre
            displayTitleGame();
            // Affichage du quadrillage
            for (i = 0; i < 672; i = i + 32) {
                context.beginPath();
                context.moveTo(i, 0);
                context.lineTo(i, context.height);
                context.strokeStyle = "black";
                context.lineWidth = 1;
                context.stroke();
            }
            for (j = 0; j - 1 < 640; j = j + 32) {
                context.beginPath();
                context.moveTo(0, j);
                context.lineTo(640, j);
                context.strokeStyle = "black";
                context.lineWidth = 1;
                context.stroke();
            }

            //affichage pièce 18
            /*for (k=0; k<piece18.tab.length; k++) {
                for (l=0; l<piece18.tab[0].length; l++){
                    if  (piece18.tab[k][l] == true){
                        context.fillStyle = piece18.couleur;
                        context.fillRect(piece18.x + l * 32, piece18.y+k*32,piece18.largeur,piece18.hauteur);


                    }
                }
            }*/
            //affichage de toutes les pieces
            afficherPieceTurn();
           
            
            displayWhichPlayer(); // peut être dans l'update ?
            
            //affichageP('R');
          
        }

        /////////////FIN DES FONCTIONS POUR FAIRE FONCTIONNER LE JEU ///////////////
        ///////////////////// LES FONCTIONS HASARD //////////////////


        harsardIntervalle = function (min, max) {
            var tire;
            tire = Math.round(min + (Math.random() * ((max - min) + 1)));
            return tire;
        }

        //////////////////////// FIN FONCTON HASARD /////////////////////
        //////////////////////// FONCTION CLAVIER ////////////////////////

        /**
         *  Fonction appelée lorsqu'une touche du clavier est appuyée
         *  Associée à l'événement "keyDown"
         */
        captureAppuiToucheClavier = function (event) {
            // pratique pour connaître les keyCode des touches du clavier :
            //KeyCode: 39 -> right arrow
            //KeyCode: 37  -> left arrow
            //KeyCode : 38 -> up arrow
            //KeyCode : 40 -> down arrow


        }
        /**
         *  Fonction appelée lorsqu'une touche du clavier est relâchée
         *  Associée à l'événement "keyUp"
         */
        //  --> http://www.cambiaresearch.com/articles/15/javascript-key-codes
        captureRelacheToucheClavier = function (event) {


        }



        ////////////////////////FIN FONCTION CLAVIER ////////////////////
        ////////////////////// FONCTION SOURIS /////////////////////////
        /**
        *  Fonction appelée lorsqu'une touche du clavier est relâchée
        *  Associée à l'événement "click"
        */
        captureClicSouris = function (event) {
            if (event.target.id == "cvs") {
                clic.x = event.pageX - event.target.offsetLeft;
                clic.y = event.pageY - event.target.offsetTop;

            }

            //selectionnerPiece();

            if (poser) {
                poser = false;
            }      
        }
        movePiece = function (e) {
            var piece = selectionnerPiece();
            if (poser == false && !piece.lock) {
                if (event.target.id == "cvs") {
                    piece.x = e.pageX - e.target.offsetLeft;
                    piece.y = e.pageY - e.target.offsetTop;
                }
            }
            
        }
        function doubleClick() {
            var piece = selectionnerPiece();
               poser = true;
               piece.lock = true;
        }
        tournePieceAxialHorizontal = function (z, pieceX) {
                    for (k = 0; k < ttpieces["piece" + z].tab.length; k++) {
                        for (l = 0; l < ttpieces["piece" + z].tab[0].length; l++) {
                            pieceX.tab[k][l] = false;
                        }
                    }
                    for (k = 0; k < ttpieces["piece" + z].tab.length; k++) {
                        for (l = 0; l < ttpieces["piece" + z].tab[0].length; l++) {
                            if (ttpieces["piece" + z].tab[k][l] == true) {

                                pieceX.tab[ttpieces["piece" + z].tab.length - 1 - k][l] = true;
                            } 
                        }
                    }
                    for (k = 0; k < ttpieces["piece" + z].tab.length; k++) {
                        for (l = 0; l < ttpieces["piece" + z].tab[0].length; l++) {
                           ttpieces["piece" + z].tab[k][l] = pieceX.tab[k][l];
                        }
                    }
                    return ttpieces["piece" + z];
        }
        tournePieceAxialVertical = function (z, pieceX) {
            for (k = 0; k < ttpieces["piece" + z].tab.length; k++) {
                for (l = 0; l < ttpieces["piece" + z].tab[0].length; l++) {
                    pieceX.tab[k][l] = false;
                }
            }
            for (k = 0; k < ttpieces["piece" + z].tab.length; k++) {
                for (l = 0; l < ttpieces["piece" + z].tab[0].length; l++) {
                    if (ttpieces["piece" + z].tab[k][l] == true) {

                        pieceX.tab[k][ttpieces["piece" + z].tab.length - 1 - l] = true;
                    }
                }
            }
            for (k = 0; k < ttpieces["piece" + z].tab.length; k++) {
                for (l = 0; l < ttpieces["piece" + z].tab[0].length; l++) {
                    ttpieces["piece" + z].tab[k][l] = pieceX.tab[k][l];
                }
            }
            return ttpieces["piece" + z];
        }
        tournePieceCentral = function (z, pieceX) {
            for (k = 0; k < ttpieces["piece" + z].tab.length; k++) {
                for (l = 0; l < ttpieces["Piece" + z].tab[0].length; l++) {
                    pieceX.tab[k][l] = false;
                }
            }
            for (k = 0; k < ttpieces["piece" + z].tab.length; k++) {
                for (l = 0; l < ttpieces["piece" + z].tab[0].length; l++) {
                    if (ttpieces["piece" + z].tab[k][l] == true) {

                        pieceX.tab[l][k] = true;
                    }
                }
            }
            for (k = 0; k < ttpieces["piece" + z].tab.length; k++) {
                for (l = 0; l < ttpieces["piece" + z].tab[0].length; l++) {
                    ttpieces["piece" + z].tab[k][l] = pieceX.tab[k][l];
                }
            }
            return ttpieces["piece" + z];
        }
        //////////////////////FIN FONCTION SOURIS //////////////////////
        //////////////////////FCT AFFICHAGE ///////////////////////////
        displayWhichPlayer = function(){
            if (turn.turnBleu) {
                turn.turnRed, turn.turnYellow, turn.turnGreen = false;
                couleur = "blue";
              for (i = 1; i < 32; i = i + 1) {
                    context.beginPath();
                    context.moveTo(640, i);
                    context.lineTo(context.width, i);
                    context.strokeStyle = "blue";
                    context.lineWidth = 1;
                    context.stroke();
                }
            } else if (turn.turnRed) {
                turn.turnBleu, turn.turnYellow, turn.turnGreen = false;
                couleur = "red";
                 for (i = 1; i < 32; i = i + 1) {
                    context.beginPath();
                    context.moveTo(640, i);
                    context.lineTo(context.width, i);
                    context.strokeStyle = "red";
                    context.lineWidth = 1;
                    context.stroke();
                }


            } else if (turn.turnGreen) {
                turn.turnBleu, turn.turnYellow, turn.turnRed = false;
                couleur = "green";
                 for (i = 1; i < 32; i = i + 1) {
                    context.beginPath();
                    context.moveTo(640, i);
                    context.lineTo(context.width, i);
                    context.strokeStyle = "green";
                    context.lineWidth = 1;
                    context.stroke();
                }
            } else {
                turn.turnBleu, turn.turnGreen, turn.turnRed = false;
                couleur = "yellow";
                 for (i = 1; i < 32; i = i + 1) {
                    context.beginPath();
                    context.moveTo(640, i);
                    context.lineTo(context.width, i);
                    context.strokeStyle = "yellow";
                    context.lineWidth = 1;
                    context.stroke();
                }    
            }
        
        }
        displayTitleGame = function(){
             if (testB==0){
            testB++;
            var img = document.createElement("img");
            img.src = 'blokus2.jpg';
            img.setAttribute("height", "75");
            img.setAttribute("width", "100");
            img.setAttribute("alt", "Blokus");
            
            var d = document.getElementById("imageBlokus");
            d.append(img);
            d.setAttribute("style", "text-align:center");
            }  
            
            
        
        }
        affichageP = function (carac){
            switch (carac) {
                case 'R':
                    affichagePieceRouge();
                break;
                case 'V':
                     affichagePieceVerte();   
                break;
                case 'J':
                      affichagePieceJaune(); 
                break;
                case 'B':
                     affichagePieceBleue(); 
                break;


            } 
        }
        // Affichage des pieces        
        // On verifie si la piece est lock ou pas
        // Si lock est vrai alors la piece ne s'affiche pas a droite de la grille
        affichagePieceD = function (carac) {
          for (z = 1; z <= 21; z++) {
            for (k = 0; k < ttjoueur["joueur" + carac].ttpieces["piece" + z].tab.length; k++) {
              for (l = 0; l < ttjoueur["joueur" + carac].ttpieces["piece" + z].tab[0].length; l++) {
                 if (ttjoueur["joueur" + carac].ttpieces["piece" + z].tab[k][l] == true && ttjoueur["joueur" + carac].ttpieces["piece" + z].lock == false) {
                     
                     
                     context.fillStyle = ttjoueur["joueur" + carac].ttpieces["piece" + z].couleur;
                     context.fillRect(ttjoueur["joueur" + carac].ttpieces["piece" + z].x + k * 32, ttjoueur["joueur" + carac].ttpieces["piece" + z].y + l * 32, ttjoueur["joueur" + carac].ttpieces["piece" + z].largeur, ttjoueur["joueur" + carac].ttpieces["piece" + z].hauteur);
                 }
               }
             }
            }
          }
        affichagePieceRouge = function(){
           for (i=1; i<=21; i++){
                creePieceR(i);
                
            }
         }   
        affichagePieceVerte = function() {
            for (i=1; i<=21; i++){
                creePieceV(i);   
            }
        }
        affichagePieceJaune = function(){
            for (i=1; i<=21; i++){
                creePieceJ(i);   
            }
        }
        affichagePieceBleu = function() {
            for (i=1; i<=21; i++){
                creePieceB(i);   
            }
        }
        creePieceR = function(n){
            switch(n){
                case 1:
                   
                 for (k=0; k<=JoueurRouge.piece1.tab.length-1; k++) {
                    for (l= 0; l<=JoueurRouge.piece1.tab[0].length-1; l++){

                           if (JoueurRouge.piece1.tab[k][l] == true && JoueurRouge.piece1.lock == false){
                             context.fillStyle = JoueurRouge.piece1.couleur; 
                             context.fillRect(l*32,k*32,JoueurRouge.piece1.largeur,JoueurRouge.piece1.hauteur);
                          }


                    }
                }
                break;
                case 2:
                   
                 for (k=0; k<=JoueurRouge.piece2.tab.length-1; k++) {
                    for (l= 0; l<=JoueurRouge.piece2.tab[0].length-1; l++){

                           if (JoueurRouge.piece2.tab[k][l] == true && JoueurRouge.piece2.lock == false){
                             context.fillStyle = JoueurRouge.piece2.couleur; 
                             context.fillRect(l*32,k*32,JoueurRouge.piece2.largeur,JoueurRouge.piece2.hauteur);
                          }


                    }
                }
                break;
                case 3:
                   
                 for (k=0; k<=JoueurRouge.piece3.tab.length-1; k++) {
                    for (l= 0; l<=JoueurRouge.piece3.tab[0].length-1; l++){

                           if (JoueurRouge.piece3.tab[k][l] == true && JoueurRouge.piece3.lock == false){
                             context.fillStyle = JoueurRouge.piece3.couleur; 
                             context.fillRect(l*32,k*32,JoueurRouge.piece3.largeur,JoueurRouge.piece3.hauteur);
                          }


                    }
                }
                break;
                case 4:
                   
                for (k=0; k<=JoueurRouge.piece4.tab.length-1; k++) {
                    for (l= 0; l<=JoueurRouge.piece4.tab[0].length-1; l++){

                           if (JoueurRouge.piece4.tab[k][l] == true && JoueurRouge.piece4.lock == false){
                             context.fillStyle = JoueurRouge.piece4.couleur; 
                             context.fillRect(l*32,k*32,JoueurRouge.piece4.largeur,JoueurRouge.piece4.hauteur);
                          }


                    }
                }
                break;
                case 5:
                   
                for (k=0; k<=JoueurRouge.piece5.tab.length-1; k++) {
                    for (l= 0; l<=JoueurRouge.piece5.tab[0].length-1; l++){

                           if (JoueurRouge.piece5.tab[k][l] == true && JoueurRouge.piece5.lock == false){
                             context.fillStyle = JoueurRouge.piece5.couleur; 
                             context.fillRect(l*32,k*32,JoueurRouge.piece5.largeur,JoueurRouge.piece5.hauteur);
                          }


                    }
                }
                break;
                case 6:
                   
                for (k=0; k<=JoueurRouge.piece6.tab.length-1; k++) {
                    for (l= 0; l<=JoueurRouge.piece6.tab[0].length-1; l++){

                           if (JoueurRouge.piece6.tab[k][l] == true && JoueurRouge.piece6.lock == false){
                             context.fillStyle = JoueurRouge.piece6.couleur; 
                             context.fillRect(l*32,k*32,JoueurRouge.piece6.largeur,JoueurRouge.piece6.hauteur);
                          }


                    }
                }
                break;
                case 7:
                   
                for (k=0; k<=JoueurRouge.piece7.tab.length-1; k++) {
                    for (l= 0; l<=JoueurRouge.piece7.tab[0].length-1; l++){

                           if (JoueurRouge.piece7.tab[k][l] == true && JoueurRouge.piece7.lock == false){
                             context.fillStyle = JoueurRouge.piece7.couleur; 
                             context.fillRect(l*32,k*32,JoueurRouge.piece7.largeur,JoueurRouge.piece7.hauteur);
                          }


                    }
                }
                break;
                case 8:
                   
                for (k=0; k<=JoueurRouge.piece8.tab.length-1; k++) {
                    for (l= 0; l<=JoueurRouge.piece8.tab[0].length-1; l++){

                           if (JoueurRouge.piece8.tab[k][l] == true && JoueurRouge.piece8.lock == false){
                             context.fillStyle = JoueurRouge.piece8.couleur; 
                             context.fillRect(l*32,k*32,JoueurRouge.piece8.largeur,JoueurRouge.piece8.hauteur);
                          }


                    }
                }
                break;
                case 9:
                   
                for (k=0; k<=JoueurRouge.piece9.tab.length-1; k++) {
                    for (l= 0; l<=JoueurRouge.piece9.tab[0].length-1; l++){

                           if (JoueurRouge.piece9.tab[k][l] == true && JoueurRouge.piece9.lock == false){
                             context.fillStyle = JoueurRouge.piece9.couleur; 
                             context.fillRect(l*32,k*32,JoueurRouge.piece9.largeur,JoueurRouge.piece9.hauteur);
                          }


                    }
                }
                break;
                case 10:
                   
                 for (k=0; k<=JoueurRouge.piece10.tab.length-1; k++) {
                    for (l= 0; l<=JoueurRouge.piece10.tab[0].length-1; l++){

                           if (JoueurRouge.piece10.tab[k][l] == true && JoueurRouge.piece10.lock == false){
                             context.fillStyle = JoueurRouge.piece10.couleur; 
                             context.fillRect(l*32,k*32,JoueurRouge.piece10.largeur,JoueurRouge.piece10.hauteur);
                          }


                    }
                }
                break;
                case 11:
                   
                for (k=0; k<=JoueurRouge.piece11.tab.length-1; k++) {
                    for (l= 0; l<=JoueurRouge.piece11.tab[0].length-1; l++){

                           if (JoueurRouge.piece11.tab[k][l] == true && JoueurRouge.piece11.lock == false){
                             context.fillStyle = JoueurRouge.piece11.couleur; 
                             context.fillRect(l*32,k*32,JoueurRouge.piece11.largeur,JoueurRouge.piece11.hauteur);
                          }


                    }
                }
                break;
                case 12:
                   
                 for (k=0; k<=JoueurRouge.piece12.tab.length-1; k++) {
                    for (l= 0; l<=JoueurRouge.piece12.tab[0].length-1; l++){

                           if (JoueurRouge.piece12.tab[k][l] == true && JoueurRouge.piece12.lock == false){
                             context.fillStyle = JoueurRouge.piece12.couleur; 
                             context.fillRect(l*32,k*32,JoueurRouge.piece12.largeur,JoueurRouge.piece12.hauteur);
                          }


                    }
                }
                break;
                case 13:
                   
                for (k=0; k<=JoueurRouge.piece13.tab.length-1; k++) {
                    for (l= 0; l<=JoueurRouge.piece13.tab[0].length-1; l++){

                           if (JoueurRouge.piece13.tab[k][l] == true && JoueurRouge.piece13.lock == false){
                             context.fillStyle = JoueurRouge.piece13.couleur; 
                             context.fillRect(l*32,k*32,JoueurRouge.piece13.largeur,JoueurRouge.piece13.hauteur);
                          }


                    }
                }
                break;
                case 14:
                   
                 for (k=0; k<=JoueurRouge.piece14.tab.length-1; k++) {
                    for (l= 0; l<=JoueurRouge.piece14.tab[0].length-1; l++){

                           if (JoueurRouge.piece14.tab[k][l] == true && JoueurRouge.piece14.lock == false){
                             context.fillStyle = JoueurRouge.piece14.couleur; 
                             context.fillRect(l*32,k*32,JoueurRouge.piece14.largeur,JoueurRouge.piece14.hauteur);
                          }


                    }
                }
                break;
                case 15:
                   
                 for (k=0; k<=JoueurRouge.piece15.tab.length-1; k++) {
                    for (l= 0; l<=JoueurRouge.piece15.tab[0].length-1; l++){

                           if (JoueurRouge.piece15.tab[k][l] == true && JoueurRouge.piece15.lock == false){
                             context.fillStyle = JoueurRouge.piece15.couleur; 
                             context.fillRect(l*32,k*32,JoueurRouge.piece15.largeur,JoueurRouge.piece15.hauteur);
                          }


                    }
                }
                break;
                case 16:
                   
                 for (k=0; k<=JoueurRouge.piece16.tab.length-1; k++) {
                    for (l= 0; l<=JoueurRouge.piece16.tab[0].length-1; l++){

                           if (JoueurRouge.piece16.tab[k][l] == true && JoueurRouge.piece16.lock == false){
                             context.fillStyle = JoueurRouge.piece16.couleur; 
                             context.fillRect(l*32,k*32,JoueurRouge.piece16.largeur,JoueurRouge.piece16.hauteur);
                          }


                    }
                }
                break;
                case 17:
                   
                 for (k=0; k<=JoueurRouge.piece17.tab.length-1; k++) {
                    for (l= 0; l<=JoueurRouge.piece17.tab[0].length-1; l++){

                           if (JoueurRouge.piece17.tab[k][l] == true && JoueurRouge.piece17.lock == false){
                             context.fillStyle = JoueurRouge.piece17.couleur; 
                             context.fillRect(l*32,k*32,JoueurRouge.piece17.largeur,JoueurRouge.piece17.hauteur);
                          }


                    }
                }
                break;
                case 18:
                   
                 for (k=0; k<=JoueurRouge.piece18.tab.length-1; k++) {
                    for (l= 0; l<=JoueurRouge.piece18.tab[0].length-1; l++){

                           if (JoueurRouge.piece18.tab[k][l] == true && JoueurRouge.piece18.lock == false){
                             context.fillStyle = JoueurRouge.piece18.couleur; 
                             context.fillRect(l*32,k*32,JoueurRouge.piece18.largeur,JoueurRouge.piece18.hauteur);
                          }


                    }
                }
                break;
                 case 19:
                   
                 for (k=0; k<=JoueurRouge.piece19.tab.length-1; k++) {
                    for (l= 0; l<=JoueurRouge.piece19.tab[0].length-1; l++){

                           if (JoueurRouge.piece19.tab[k][l] == true && JoueurRouge.piece19.lock == false){
                             context.fillStyle = JoueurRouge.piece19.couleur; 
                             context.fillRect(l*32,k*32,JoueurRouge.piece19.largeur,JoueurRouge.piece19.hauteur);
                          }


                    }
                }
                break;
                 case 20:
                   
                 for (k=0; k<=JoueurRouge.piece20.tab.length-1; k++) {
                    for (l= 0; l<=JoueurRouge.piece20.tab[0].length-1; l++){

                           if (JoueurRouge.piece20.tab[k][l] == true && JoueurRouge.piece20.lock == false){
                             context.fillStyle = JoueurRouge.piece20.couleur; 
                             context.fillRect(l*32,k*32,JoueurRouge.piece20.largeur,JoueurRouge.piece20.hauteur);
                          }


                    }
                }
                break;
                 case 21:
                   
                for (k=0; k<=JoueurRouge.piece21.tab.length-1; k++) {
                    for (l= 0; l<=JoueurRouge.piece21.tab[0].length-1; l++){

                           if (JoueurRouge.piece21.tab[k][l] == true && JoueurRouge.piece21.lock == false){
                             context.fillStyle = JoueurRouge.piece21.couleur; 
                             context.fillRect(l*32,k*32,JoueurRouge.piece21.largeur,JoueurRouge.piece21.hauteur);
                          }


                    }
                }
                break;
                    
            }
            
            
            
        }
        
        //////////////////////FIN FONCTION AFFICHAGE///////////////////
       /////////////////////// FONCTION PIECE /////////////////////////
        
        // fonction pour verifier si on clique sur une piece
        // Si oui, on peut bouger la piece
        selectionnerPiece = function () {
             var i = 1;
             var trouver = false;
              
             while (!trouver && i <=21  ) {
                 if (trouverPiece(i) == true){

                     trouver = true;


                 }
                 else {
                     
                     i++;
                 }
             
             
             
            
             }
              
             switch(i){
                 case 1:
                  return "piece1"
                 break;
                 case 2:
                  return "piece2"        
                 break;
                 case 3:
                  return "piece3"        
                 break;
                 case 4:
                  return "piece4"               
                 break;
                 case 5:
                  return "piece5"        
                 break;
                 case 6:
                  return "piece6"        
                 break;
                 case 7:
                  return "piece7"  
                 break;
                 case 8:
                  return "piece8"           
                 break;
                 case 9:
                    return "piece9"          
                 break;
                 case 10:
                   return "piece10"        
                 break;
                 case 11:
                  return "piece11"        
                 break;
                 case 12:
                     return "piece12"        
                 break;
                 case 13:
                      return "piece13"        
                 break;
                 case 14:
                    return "piece14"        
                 break;
                 case 15:
                     return "piece15"        
                 break;
                 case 16:
                     return "piece16"        
                 break;
                 case 17:
                     return "piece17"        
                 break;
                 case 18:
                       return "piece18"        
                 break;
                 case 19:
                      return "piece19"        
                 break;
                 case 20:
                       return "piece20"        
                 break;
                 case 21:
                       return "piece21"        
                 break;

              }



        }
                 
          
          
        // Fonction pour bouger les pieces
        // On verifie que poser est faux et que la piece n est pas lock
       /* movePiece = function(e){
            
            if (poser == false && !piece.lock){
                if (event.target.id == "cvs") {
                    piece.x = e.pageX - e.target.offsetLeft;
                    piece.y = e.pageY - e.target.offsetTop;
                }
            }            
        }
        */
          
          
        
        // Trouver piece
        // Utilisation de clic.x et clic.y
        trouverPiece = function (i,couleur){
                var ttt = false;
            switch (couleur) {
                case 'rouge':
                switch (i){
                 case 1:
                 
                 break;
                 case 2:
                 
                 break;
                 case 3:
                      
                 break;
                 case 4:
                              
                 break;
                 case 5:
                   
                 break;
                 case 6:
                 
                 break;
                 case 7:
                
                 break;
                 case 8:
                 
                 break;
                 case 9:
                   
                 break;
                 case 10:
                     
                 break;
                 case 11:
                    
                 break;
                 case 12:
                          
                 break;
                 case 13:
                       
                 break;
                 case 14:
                    
                 break;
                 case 15:
                    
                 break;
                 case 16:
                    
                 break;
                 case 17:
                           
                 break;
                 case 18:
                       if   ( ((clic.x > piece18.x && clic.x < piece18.x + piece18.largeur*2)  && (clic.y > piece18.y && clic.y < piece18.y+piece18.hauteur)) || 
                            ( (clic.x > piece18.x+piece18.largeur && clic.x < piece18.x+piece18.largeur*3)&& (clic.y > piece18.y+piece18.hauteur && clic.y < piece18.y + piece18.hauteur*2))       ||
                            ( (clic.x > piece18.x+piece18.largeur*2 && clic.x < piece18.x+piece18.largeur*3) && (clic.y > piece18.y+ piece18.hauteur*2 && clic.y < piece18.y+ piece18.hauteur*3) ) )  {
                           
                           
                            return ttt = true;    
                       }
                 break;
                 case 19:
                      
                 break;
                 case 20:
                     
                 break;
                 case 21:
                             
                 break;

            
            
                }
                break;
                case 'bleu':
                    
                    
                break;
                case 'vert':
                    
                    
                    
                break;
                case 'jaune': 
                    
                    
                break;
            }
            
        }
        
        afficherPieceTurn= function(){ 
            if (turn.turnBleu){
            col = "blue";
            for (z = 1; z <= 21; z++) {
                for (k = 0; k < ttpiecesB["piece" + z + col].tab.length; k++) {
                    for (l = 0; l < ttpiecesB["piece" + z + col].tab[0].length; l++) {
                        if (ttpiecesB["piece" + z].tab[k][l] == true) {
                            context.fillStyle = ttpiecesB["piece" + z].couleur;
                            context.fillRect(ttpiecesB["piece" + z].x + k * 32, ttpiecesB["piece" + z].y + l * 32, ttpiecesB["piece" + z].largeur, ttpiecesB["piece" + z].hauteur);

                        }



                    }
                }
            }    
            turn.turnBleu = false;
            turn.turnYellow = true;
            }else if(turn.turnRed){
            col = "red";
            for (z = 1; z <= 21; z++) {
                for (k = 0; k < ttpiecesR["piece" + z + col].tab.length; k++) {
                    for (l = 0; l < ttpiecesR["piece" + z + col].tab[0].length; l++) {
                        if (ttpiecesR["piece" + z+ col].tab[k][l] == true) {
                            context.fillStyle = ttpiecesR["piece" + z+ col].couleur;
                            context.fillRect(ttpiecesR["piece" + z+ col].x + k * 32, ttpiecesR["piece" + z+ col].y + l * 32, ttpiecesR["piece" + z+ col].largeur, ttpiecesR["piece" + z+ col].hauteur);

                        }



                    }
                }
            }        
                
            turn.turnRed = false;
            turn.turnBleu = true;    
            }else if(turn.turnYellow){
            col = "yellow";
            for (z = 1; z <= 21; z++) {
                for (k = 0; k < ttpiecesJ["piece" + z + col].tab.length; k++) {
                    for (l = 0; l < ttpiecesJ["piece" + z + col].tab[0].length; l++) {
                        if (ttpiecesJ["piece" + z+ col].tab[k][l] == true) {
                            context.fillStyle = ttpiecesJ["piece" + z+ col].couleur;
                            context.fillRect(ttpiecesJ["piece" + z+ col].x + k * 32, ttpiecesJ["piece" + z+ col].y + l * 32, ttpiecesJ["piece" + z+ col].largeur, ttpiecesJ["piece" + z+ col].hauteur);

                        }



                    }
                }
            }           
            turn.turnYellow = false;
            turn.turnGreen = true;    
            }else if(turn.turnGreen){
            col = "green";
            for (z = 1; z <= 21; z++) {
                for (k = 0; k < ttpiecesG["piece" + z + col].tab.length; k++) {
                    for (l = 0; l < ttpiecesG["piece" + z + col].tab[0].length; l++) {
                        if (ttpiecesG["piece" + z+ col].tab[k][l] == true) {
                            context.fillStyle = ttpiecesG["piece" + z+ col].couleur;
                            context.fillRect(ttpiecesG["piece" + z+ col].x + k * 32, ttpiecesG["piece" + z+ col].y + l * 32, ttpiecesG["piece" + z+ col].largeur, ttpiecesG["piece" + z+ col].hauteur);

                        }



                    }
                }
            }       
                
            turn.turnGreen = false;
            turn.turnRed = true;    
            }else{
                console.log("bug");
            }
        }
        
         ///////////////////////FIN FONCTION PIECE /////////////////////////
        ////////////////////// FIN DES FONCTION /////////////////////// 

    </script>
        
        
    </head>
   <!-- /////////////// FIN HEAD ///////////////////// -->
    
   <!-- /////////////// BODY //////////////////// -->
<body onload="init()" style="background-color: black;">
<div id="imageBlokus"></div>
<canvas id="cvs" width="1400" height="640" style="margin: 10px auto; border: solid 1px #000000; background-color:floralwhite; "  ondblclick="doubleClick()" >
        <!-- un petit carre fait 32 par 32-->
</canvas>

    

</body>
    <!-- ///////////////FIN BODY //////////////////// -->
</html>